# -------------------------------
# MapProxy configuration.
#
# OSM example based on https://wiki.openstreetmap.org/wiki/MapProxy
# -------------------------------
services:
  demo:
  wmts:
    kvp: true
    restful: true 

layers:
  - name: osm
    title: Open Streetmap Tiles
    sources: [osm_cache]
  - name: osm-nl
    title: Open Streetmap Tiles Nederland
    sources: [osm_nl_cache] 

caches:
  osm_cache:
    sources: [osm_tiles]
    grids: [GLOBAL_MERCATOR]
    format: image/png
    cache:
      type: geopackage
      filename: /srv/mapproxy/cachedata/osm.gpkg
      table_name: osm_tiles
  osm_nl_cache:
    sources: [osm_cache] 
    grids: [nlgrid]

sources:
  osm_tiles:
    type: tile
    url: http://c.tile.openstreetmap.org/%(tms_path)s.%(format)s
    grid: osm_grid 
 
grids:
  osm_grid:
    srs: EPSG:900913
    origin: nw
  nlgrid:
    srs: EPSG:28998 
    bbox: [3.2,50.75,7.22,53.7]
    bbox_srs: EPSG:4326
    origin: 'nw'

globals:
  cache:
    base_dir: '/srv/mapproxy/cache'
    lock_dir: '/srv/mapproxy/cache/locks'
    tile_lock_dir: '/srv/mapproxy/cache/tile_locks'

  image:
      resampling_method: bilinear
      jpeg_quality: 90